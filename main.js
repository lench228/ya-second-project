(()=>{var e={999:e=>{const t=/^[^:]+: /;class n extends Error{constructor(e){super();const{name:n,message:r,codeFrame:o,hideStack:c}=(e=>(e instanceof SyntaxError?(e.name="SyntaxError",e.message=e.message.replace(t,""),e.hideStack=!0):e instanceof TypeError&&(e.name=null,e.message=e.message.replace(t,""),e.hideStack=!0),e))(e);this.name="BabelLoaderError",this.message=`${n?`${n}: `:""}${r}\n\n${o}\n`,this.hideStack=c,Error.captureStackTrace(this,this.constructor)}}e.exports=n}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}(()=>{"use strict";var e=function(e,t){var n=t.submitButtonSelector,r=t.submitButtonInactiveClass,o=e.querySelector(n);e.checkValidity()?(o.removeAttribute("disabled"),o.classList.remove(r)):(o.setAttribute("disabled",!0),o.classList.add(r))},t={baseUrl:"https://nomoreparties.co/v1/frontend-st-cohort-201",headers:{authorization:"1a9d1eca-3f6b-4cef-9232-0e22b5dc9124","Content-Type":"application/json"}},r=".card__like_button",o="card__like_button_is-active",c=".card",a=function(e,t,n){var c=e.querySelector(r);e.querySelector(".card__like_counter").textContent=t.likes.length,t.likes.some((function(e){return e._id===n}))?c.classList.add(o):c.classList.remove(o)},i=function(e,n,i,s,u){var l=n.content.cloneNode(!0),d=l.firstElementChild,p=l.querySelector(".card__image"),f=l.querySelector(".card__title");p.src=e.link,f.textContent=e.name,d.setAttribute("id",e._id),p.addEventListener("click",(function(t){return i(e)}));var m=l.querySelector(".card__delete-button");return e.owner._id!==u?m.style.display="none":m.addEventListener("click",(function(e){return function(e){var n;(n=e.currentTarget.closest(c).id,fetch("".concat(t.baseUrl,"/cards/").concat(n),{headers:t.headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(){window.location.reload()})).catch((function(e){console.log(e)}))}(e)})),function(e,n,i){a(e,n,i),e.querySelector(r).addEventListener("click",(function(e){return function(e,n,r){var i,s=e.currentTarget,u=document.getElementById(s.closest(c).id);s.classList.contains(o)?(i=n,fetch("".concat(t.baseUrl,"/cards/likes/").concat(i),{headers:t.headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){a(u,e,r)})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{headers:t.headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).then((function(e){a(u,e,r)})).catch((function(e){console.log(e)}))}(e,n._id,i)}))}(l,e,u),l},s="popup_is-opened",u=function(e){document.body.addEventListener("keydown",d),e.classList.add(s)},l=function(e){document.body.removeEventListener("keydown",d),e.classList.remove(s)};document.body.addEventListener("click",(function(e){return function(e){e.target.classList.contains(s)&&e.target.classList.remove(s)}(e)}));var d=function(e){if("Escape"===e.key){var t=document.querySelector("."+s);l(t)}},p=(n(999),document.querySelector(".profile__title")),f=document.querySelector(".profile__description"),m=document.querySelector(".profile__image"),h=document.querySelector(".profile__edit-button"),v=document.querySelector(".popup_type_edit"),_=v.querySelector(".popup__form"),y=_.elements.name,S=_.elements.description,b=function(e,t,n){p.textContent=e,f.textContent=t,m.style.backgroundImage="url(".concat(n,")")},g=fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return b(e.name,e.about,e.avatar),e})).catch((function(e){p.textContent=e,f.textContent="",m.style.backgroundImage=""}));h.addEventListener("click",(function(e){return t=p.textContent,n=f.textContent,y.value=t,S.value=n,void u(v);var t,n})),_.addEventListener("submit",(function(e){e.preventDefault();var n,r,o=e.currentTarget.querySelector(".button");o.textContent="Сохранение...",o.disabled=!0,(n=y.value,r=S.value,fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers,body:JSON.stringify({name:n,about:r}),method:"PATCH"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){var t=e.name,n=e.about,r=e.avatar;b(t,n,r)})).catch((function(e){console.log(e)})).finally((function(){o.disabled=!1,o.textContent="Сохранить"})),l(v)}));var k,E,q,C=document.querySelector(".popup_type_avatar"),x=document.querySelector(".profile__image"),L=C.querySelector(".popup__form"),P=document.querySelector("#card-template"),j=document.querySelector(".places__list"),T={profilePopup:v,cardPopup:document.querySelector(".popup_type_new-card"),imagePopup:document.querySelector(".popup_type_image"),avatarPopup:C},A=document.querySelector(".profile__add-button"),U=T.cardPopup.querySelector(".popup__form"),w=U.elements["place-name"],B=U.elements.link,I=document.querySelector(".popup__caption"),M=document.querySelector(".popup__image"),D=function(e){I.textContent=e.name,M.src=e.link,u(T.imagePopup)};q="",Object.values(T).forEach((function(e){!function(e){var t=e.querySelector(".popup__close");e.classList.add("popup_is-animated"),t.addEventListener("click",(function(){return l(e)}))}(e)})),g.then((function(e){q=e._id})).catch((function(e){return console.error(e)})),fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){!function(e,t){var n=i(e,P,D,0,t);j.appendChild(n)}(e,q)}))})).catch((function(e){return console.log(e)})),E=(k={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",submitButtonInactiveClass:"popup__button_inactive",inputErrorClass:"popup__input_error",errorActiveClass:"popup__error_active",errorSelectorPrefix:".popup__error_",errors:{valueMissing:"Вы пропустили это поле",tooShort:"Слишком мало символов",typeMismatch:"Введите url",default:"Ошибка."}}).formSelector,Array.from(document.querySelectorAll(E)).forEach((function(t){(function(t,n){var r=n.inputSelector;Array.from(t.querySelectorAll(r)).forEach((function(r){r.addEventListener("input",(function(){!function(t,n,r){n.validity.valid?function(e,t,n){var r=n.inputErrorClass,o=n.errorActiveClass,c=n.errorSelectorPrefix,a=e.querySelector("".concat(c).concat(t.name));t.classList.remove(r),a.classList.remove(o),a.textContent=""}(t,n,r):function(e,t,n,r){var o=r.inputErrorClass,c=r.errorSelectorPrefix,a=r.errors,i=r.errorActiveClass,s=e.querySelector("".concat(c).concat(t.name));t.classList.add(o),n.valueMissing?s.textContent=a.valueMissing:n.tooShort?s.textContent=a.tooShort:n.typeMismatch?s.textContent=a.typeMismatch:s.textContent=a.default,s.classList.add(i)}(t,n,n.validity,r),e(t,r)}(t,r,n)}))}))})(t,k),e(t,k)})),x.addEventListener("click",(function(e){u(C)})),L.addEventListener("submit",(function(e){!function(e){e.preventDefault();var n,r=e.currentTarget,o=r.querySelector(".button");o.textContent="Сохранение...",o.disabled=!0,(n=r.elements["avatar-link"].value,fetch("".concat(t.baseUrl,"/users/me/avatar"),{headers:t.headers,method:"PATCH",body:JSON.stringify({avatar:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){x.style.backgroundImage="url("+e.avatar+")"})).catch((function(e){console.log(e)})).finally((function(){o.textContent="Сохранить",o.disabled=!1}))}(e)})),U.addEventListener("submit",(function(e){!function(e,n){e.preventDefault();var r,o,c=e.currentTarget,a=c.querySelector(".button");a.textContent="Сохранение...",a.disabled=!0,(r=c.elements.name,o=c.elements.link,fetch("".concat(t.baseUrl,"/cards "),{headers:t.headers,body:JSON.stringify({name:r,link:o}),method:"POST"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){var t=i(e,P,D,0,n);j.prepend(t),l(T.cardPopup)})).catch((function(e){console.log(e)})).finally((function(){a.textContent="Сохранить",a.disabled=!1}))}(e,q)})),A.addEventListener("click",(function(e){return w.value="",B.value="",void u(T.cardPopup)}))})()})();